version: '3.8'

services:
  gaia-dev:
    build:
      context: .
      dockerfile: Dockerfile
    image: itomek/gaia-dev:0.15.1
    container_name: ${CONTAINER_NAME:-gaia-dev}
    hostname: gaia-dev

    # Port mappings for GAIA services
    ports:
      - "${LEMONADE_PORT:-5000}:5000"  # Lemonade LLM server
      - "${GAIA_API_PORT:-8000}:8000"  # GAIA API server
      - "${WEB_PORT:-3000}:3000"       # Web applications

    # Environment configuration
    environment:
      # Lemonade server URL (defaults to localhost:5000)
      - LEMONADE_URL=${LEMONADE_URL:-http://localhost:5000/api/v1}

      # Optional: Skip pip install (for faster restarts)
      - SKIP_INSTALL=${SKIP_INSTALL:-false}

    # Optional: Mount host directory for file exchange
    # Uncomment and set HOST_DIR in your shell to enable:
    # - "${HOST_DIR}:/host"

    # Keep container running
    tty: true
    stdin_open: true

    # Resource limits (adjust as needed)
    deploy:
      resources:
        limits:
          cpus: '4'
          memory: 8G

